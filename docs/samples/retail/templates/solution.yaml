apiVersion: solution.symphony/v1
kind: SolutionContainer
metadata:
  name: retail-solution
spec:
---
apiVersion: solution.symphony/v1
kind: Solution
metadata:
  name: retail-solution-v-v1
spec:
  rootResource: retail-solution
  components:
  - name: a6aeb1f4-6c5d-44be-8a23-b865001dc6ad_1.0.2.0
    constraints: ${{$equal($property(location), 'windows')}}
    type: win.uwp
    properties:
      app.package.path: "C:\\demo\\retail\\ContosoCafeteriaKiosk\\bin\\x64\\Debug\\ContosoCafeteriaKiosk_1.0.2.0_x64_Debug.appx"
  - name: database
    type: container
    constraints: ${{$equal($property(location), 'k8s')}}
    metadata:
      service.ports: "[{\"name\":\"port3306\",\"port\": 3306,\"targetPort\":3306}]"
      service.type: ClusterIP
    properties:
      deployment.replicas: "#1"
      container.ports: "[{\"containerPort\":3306,\"protocol\":\"TCP\"}]"
      container.image: docker.io/mysql:8.4.3
      env.MYSQL_ALLOW_EMPTY_PASSWORD: "yes"
  - name: retail-backend
    type: container
    constraints: ${{$equal($property(location), 'k8s')}}
    metadata:
      service.ports: "[{\"name\":\"port3012\",\"port\": 3012,\"targetPort\":5000}]"
      service.type: ClusterIP
    properties:
      deployment.replicas: "#1"
      container.ports: "[{\"containerPort\":5000,\"protocol\":\"TCP\"}]"
      container.image: ghcr.io/lirenjie95/retail-backend:latest
      env.MYSQL_HOST: database
    dependencies:
      - database